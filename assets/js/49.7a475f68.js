(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{467:function(s,a,t){"use strict";t.r(a);var e=t(29),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"sentry"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sentry"}},[s._v("#")]),s._v(" Sentry")]),s._v(" "),t("h2",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/getsentry/onpremise.git\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" onpremise\n./install.sh\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# http://localhost:9000")]),s._v("\ndocker-compose up -d\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"升级"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#升级"}},[s._v("#")]),s._v(" 升级")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("docker-compose run --rm web upgrade\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[s._v("#")]),s._v(" 配置")]),s._v(" "),t("h3",{attrs:{id:"主要配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#主要配置文件"}},[s._v("#")]),s._v(" 主要配置文件")]),s._v(" "),t("ul",[t("li",[s._v("onpremise/.env")]),s._v(" "),t("li",[s._v("onpremise/sentry/config.yml")]),s._v(" "),t("li",[s._v("onpremise/sentry/sentry.conf.py")])]),s._v(" "),t("h3",{attrs:{id:"修改数据库配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改数据库配置"}},[s._v("#")]),s._v(" 修改数据库配置")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改sentry.conf.py DATABASES")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"磁盘占用过大的问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#磁盘占用过大的问题"}},[s._v("#")]),s._v(" 磁盘占用过大的问题")]),s._v(" "),t("h3",{attrs:{id:"修改-docker-数据存储位置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改-docker-数据存储位置"}},[s._v("#")]),s._v(" 修改 docker 数据存储位置")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在容量最大的目录下创建文件夹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /data/var/lib/\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止 docker 服务")]),s._v("\nsystemctl stop docker\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将 docker 的默认数据复制到新路径下，删除旧数据并创建软连接，即使得存储实际占用磁盘为新路径")]),s._v("\n/bin/cp -a /var/lib/docker /data/var/lib/docker "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/docker "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /data/var/lib/docker /var/lib/docker\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启 docker 服务")]),s._v("\nsystemctl start docker\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"修改数据保留时长"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改数据保留时长"}},[s._v("#")]),s._v(" 修改数据保留时长")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" .env\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 控制磁盘占用")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SENTRY_EVENT_RETENTION_DAYS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);